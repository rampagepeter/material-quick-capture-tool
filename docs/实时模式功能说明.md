# 实时模式功能说明

## 功能概述

实时模式是素材快捷投递工具的高级功能，专为需要连续收集大量素材的场景设计。启动实时模式后，应用会监听剪贴板变化，一旦检测到新的文本或图片内容，立即自动上传到飞书多维表格，无需手动确认。

## 主要特性

### 🎯 智能监听
- **剪贴板监听**：每500毫秒检测一次剪贴板变化
- **内容识别**：自动识别文本和图片内容
- **去重机制**：避免重复上传相同内容

### 🚀 快速启动
- **连续快捷键**：连续按两次智能捕获快捷键（默认 `Ctrl+Shift+T`）
- **界面控制**：在设置页面点击"启动实时模式"按钮
- **托盘菜单**：右键托盘图标选择"启动实时模式"

### 🎨 醒目提示
- **浮动窗口**：屏幕右上角显示实时模式状态窗口
- **状态指示**：红色圆点闪烁表示实时模式运行中
- **上传统计**：显示已上传数量和成功数量
- **实时反馈**：每次上传后显示成功或失败提示

## 使用场景

### 📚 在线课程/会议
- **场景**：腾讯会议、钉钉会议、Zoom会议等
- **用途**：快速收集聊天区的重要信息、截图讲解内容
- **优势**：无需手动确认，不中断会议节奏

### 💼 团队协作
- **场景**：需要收集团队成员提供的资料和反馈
- **用途**：快速整理和归档讨论内容
- **优势**：高效率，确保不遗漏重要信息

### 📖 研究学习
- **场景**：浏览文献、查阅资料
- **用途**：快速摘录关键信息和图表
- **优势**：专注阅读，无需频繁切换窗口

## 启动方式

### 方式一：连续快捷键（推荐）
1. 连续按两次智能捕获快捷键（默认 `Ctrl+Shift+T`）
2. 时间间隔需在500毫秒内
3. 第二次按键后立即启动实时模式

### 方式二：界面控制
1. 打开素材快捷投递工具主窗口
2. 切换到"设置"标签页
3. 找到"实时模式"部分
4. 点击"启动实时模式"按钮

### 方式三：托盘菜单
1. 右键点击系统托盘中的应用图标
2. 选择"启动实时模式"选项

## 退出方式

### 方式一：ESC键
- 按下 `ESC` 键立即退出实时模式

### 方式二：快捷键
- 在实时模式下，按一次智能捕获快捷键即可退出

### 方式三：界面控制
- 在设置页面点击"停止实时模式"按钮

### 方式四：托盘菜单
- 右键托盘图标选择"退出实时模式"

## 界面指示

### 实时模式窗口
- **位置**：屏幕右上角
- **大小**：350x200像素
- **内容**：
  - 🔴 实时模式图标（脉动动画）
  - 状态文本和说明
  - 上传统计数据
  - 退出提示

### 主界面状态
- **状态指示器**：红色圆点表示运行中
- **按钮文本**：显示"🟢 停止实时模式"
- **托盘图标**：菜单项更新为实时模式相关选项

## 自动上传机制

### 内容检测
1. **图片优先**：优先检测图片内容变化
2. **文本其次**：检测文本内容变化
3. **去重处理**：避免重复上传相同内容

### 上传流程
1. 检测到新内容后立即开始上传
2. 自动添加时间戳备注
3. 使用配置的提交者姓名
4. 显示上传结果通知

### 错误处理
- **网络错误**：显示错误提示，不中断实时模式
- **权限错误**：提示权限配置问题
- **配置错误**：提示检查表格配置

## 性能优化

### 资源使用
- **CPU使用**：每500毫秒检测一次，资源消耗极低
- **内存使用**：仅保存最新的剪贴板内容哈希
- **网络使用**：仅在检测到新内容时才发起请求

### 省电模式
- **间隔检测**：相比实时检测，降低电池消耗
- **智能暂停**：长时间无变化时自动调整检测频率

## 使用建议

### 最佳实践
1. **提前配置**：确保表格配置正确，避免上传失败
2. **网络稳定**：在稳定的网络环境下使用
3. **及时退出**：使用完毕后及时退出实时模式
4. **定期检查**：定期检查上传的内容是否正确

### 注意事项
1. **敏感信息**：避免在实时模式下复制敏感信息
2. **批量操作**：大量连续复制时注意网络负载
3. **权限检查**：确保飞书应用有足够的权限
4. **存储空间**：注意飞书云文档的存储空间限制

## 故障排除

### 常见问题

**Q: 实时模式无法启动？**
A: 检查以下几点：
- 飞书应用配置是否正确
- 是否选择了当前使用的表格
- 网络连接是否正常

**Q: 连续按快捷键没有反应？**
A: 
- 确认快捷键时间间隔在500毫秒内
- 检查快捷键是否与其他应用冲突
- 尝试使用界面按钮启动

**Q: 内容上传失败？**
A:
- 检查飞书应用权限配置
- 确认表格配置正确
- 检查网络连接状态

**Q: 实时模式窗口消失？**
A:
- 实时模式可能已自动退出
- 检查应用是否还在运行
- 尝试重新启动实时模式

### 日志查看
- 打开开发者工具：`--dev` 参数启动应用
- 查看控制台输出了解详细错误信息
- 检查主进程和渲染进程的日志

## 技术实现

### 核心机制
- **剪贴板监听**：使用 `setInterval` 定期检测
- **内容对比**：通过内容哈希避免重复上传
- **窗口管理**：使用 Electron 的 `alwaysOnTop` 特性
- **IPC通信**：主进程与渲染进程间的状态同步

### 关键代码
```javascript
// 连续按键检测
if (currentTime - lastShortcutTime < 500) {
  startRealtimeMode();
}

// 剪贴板监听
clipboardWatcher = setInterval(() => {
  // 检测内容变化并上传
}, 500);
```

## 更新日志

### v1.1.0 (2025-01-04)
- ✅ 新增实时模式功能
- ✅ 支持连续快捷键启动
- ✅ 醒目的状态提示窗口
- ✅ 完善的错误处理机制
- ✅ 多种启动和退出方式

---

*如有问题或建议，请联系开发团队* 